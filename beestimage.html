<!--
==========================================
 Title:       Image Page
 Creator:     @mattchen
 Last Update: 3 Oct 2020
==========================================
-->
<html ng-app="driveApp">
<head>
  <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="A simple element creator to generate responsive code that can be easily embbedded into Moodle">
    <meta name="author" content="T&M">
    <title>BEEST Image</title>
     <link rel="icon" href="img/dragon-solid-favicon.png" type="image/gif">
    <!-- external link to css file --> 
    <!-- Bootstrap CSS -->   
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- Arts CSS -->  
    <link rel="stylesheet" href="css/adminPlusSetuBlockStyle.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/monashElements.css" />
    <!-- external link to js file -->  
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="  https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <!-- Bootstrap js file --> 
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <!-- FontAwesome js file --> 
    <script src="https://kit.fontawesome.com/3817feae52.js"></script> 
    <!-- Tinymce js file -->   
    <script src='https://cloud.tinymce.com/stable/tinymce.min.js'></script>
    <script src="js/advancedModeLocalStorage.js"></script>
    <!-- TinyMCE placeholder plugin file -->
    <script src="js/placeholder.js"></script> 
	<script src="js/helperFunctions.js"></script>
	<script src="js/setupPage.js"></script>
	<script src="js/pageHistory.js"></script>
    <script>
/*REQUIRED FOR HISTORY*/   
const IMAGE_HIST = "history_image"
var localStorageHistory = IMAGE_HIST
var classImage = null
/*END REQUIRED FOR HISTORY*/   
$(document).ready(function(){
	setupGoogleAnalytics()
/*REQUIRED FOR HISTORY*/   
	initHistory()
/*END REQUIRED FOR HISTORY*/   				
	default_XRadio_onEmpty_Y("respImgHeading","headSize","noH","headSize1",generateCode)
	setupToolTips(10000)
	setupNav()
	$('#respImgSwitch').on('input', replaceLinkWithEmbed);
	makeTinyWithID('tinyMCEimage',{'change':generateCode},'[Placeholder for image context. The content you entered in step 2 will appear here.]')
	classImage = new beestImage()
	generateCode()
})
/*REQUIRED FOR HISTORY*/   
	
	$(document).ready(function(){initHistory()})
	
	class button{
		constructor(content,destination,buttonSize,icon,colour,width,newWindow,alignment,invert){
			this.mainHead = content
			this.destination = destination
			this.buttonSize = buttonSize
			this.icon = icon
			this.colour = colour
			this.invert = invert
			this.width = width
			this.newWindow = newWindow
			this.alignment = alignment
		}
		toPDO(){
			var result = {}
			result.destination = this.destination
			result.mainHead = this.mainHead
			result.buttonSize = this.buttonSize
			result.icon = this.icon
			result.colour = this.colour
			result.width = this.width
			result.newWindow = this.newWindow
			result.alignment = this.alignment
			result.invert = this.invert
			return result
		}	
		toString(){
			return JSON.stringify(this.toPDO())
		}
		fromObj(PDO){
			this.mainHead = PDO.mainHead
			this.destination = PDO.destination
			this.buttonSize = PDO.buttonSize
			this.icon = PDO.icon
			this.colour = PDO.colour
			this.width = PDO.width
			this.newWindow = PDO.newWindow
			this.alignment = PDO.alignment
			this.invert = PDO.invert

		}
	}
function getHistoryI(index,history){
	if (history.length>0){
		var selectedItem = history[index]
		classImage = new beestImage()
		classImage.fromObj(selectedItem)
		refToClassButton = classImage
		setTextAreas(refToClassButton)
		generateCode()
	}
}
function setTextAreas(classData){
	txtAreaVals = {
		'respImgSwitch': {type:'basic',value:classData.link},
		'tinyMCEimage': {type:'tiny',value:classData.context},
		'respImgHeading': {type:'basic',value:classData.heading},
		'imagePosition': {type:'radio',value:classData.position},
		'imageWidth': {type:'radio',value:classData.width},
		'headSize': {type:'radio',value:classData.size},
		'faCode': {type:'radio',value:classData.icon}
	}
	setTextAreas_util(txtAreaVals)
}

/*END REQUIRED FOR HISTORY*/
    window.gapiCallbacks=[];

    function gapiLoaded(){
      gapi.auth.init(function() {
        gapi.client.load('drive', 'v2').then(function () {
          var GapiQueue = function () {
            this.push = function (callback) {
              setTimeout(callback, 0);
            };
          };

          var _old_gapiCallbacks = window.gapiCallbacks;

          window.gapiCallbacks = new GapiQueue();

          _old_gapiCallbacks.forEach(function (callback) {
            window.gapiCallbacks.push(callback);
          });
        },function(reason){
          console.err(reason);
        });
      });
    }

    // The Browser API key obtained from the Google API Console.
    var developerKey = 'AIzaSyDc_XZvzDg7_zvLL_yZXG-hoa_2QA6MU6E';

    // The Client ID obtained from the Google API Console.
    var clientId = "97361103722-bs8u1e0lp7rnati4703leav6b4nknhg7.apps.googleusercontent.com"

    // See "Project number" under "IAM & Admin" > "Settings"
    var appId = "97361103722";

    // Scope to use to access user's Drive items.
    var scope = ['https://www.googleapis.com/auth/drive.file'];

    var pickerApiLoaded = false;
    var oauthToken;

    // Use the Google API Loader script to load the google.picker script.
    function loadPicker() {
      gapi.load('auth', {'callback': onAuthApiLoad});
      gapi.load('picker', {'callback': onPickerApiLoad});
    }
    
    // Load API key
    function onAuthApiLoad() {
      window.gapi.auth.authorize(
          {
            'client_id': clientId,
            'scope': scope,
            'immediate': false
          },
          handleAuthResult);
    }
    
    //Load Google Drive Picker
    function onPickerApiLoad() {
      pickerApiLoaded = true;
      createPicker();
    }

    function handleAuthResult(authResult) {
      if (authResult && !authResult.error) {
        oauthToken = authResult.access_token;
        createPicker();
      }
    }

    // Create and render a Picker object for searching images.
    function createPicker() {
      if (pickerApiLoaded && oauthToken) {
        var view = new google.picker.View(google.picker.ViewId.DOCS);
        view.setMimeTypes("image/png,image/jpeg,image/jpg");
        var picker = new google.picker.PickerBuilder()
            .enableFeature(google.picker.Feature.NAV_HIDDEN)
            .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)
            .setAppId(appId)
            .setOAuthToken(oauthToken)
            .addView(view)
            .addView(new google.picker.DocsUploadView())
            .setDeveloperKey(developerKey)
            .setCallback(pickerCallback)
            .build();
         picker.setVisible(true);
      }
    }

    var imageplaceholder ="https://drive.google.com/uc?id=1Tel_KpnwCcoRUMdMFyw-GJ-_MaqeaWYZ&export=download";
    var url;
    url = imageplaceholder;

    // A simple callback implementation.
    function pickerCallback(data) {
      if (data.action == google.picker.Action.PICKED) {
        var fileId = data.docs[0].id;
        url = 'https://drive.google.com/uc?id=' + fileId + '&amp;export=download';
        document.getElementById('img').src = url;
        var imagepreview = document.getElementById("imagepreview");
        imagepreview.style.display = "block";
        //var imgpreview = document.getElementById("img2");
        //imgpreview.style.display = "none";
        generateCode();
      }
    }
    
    function writeinMoodle() {
      tinyMCE.get('#id_introeditor').setContent(textOutput);
    }

    tinymce.init({
        selector: '#tinyMCEimage',
        menubar: false,
        plugins : 'advlist autolink link lists charmap print preview code placeholder',
        placeholder:'[Placeholder for image context. The content you entered in step 2 will appear here.]',
        toolbar: 'undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | numlist bullist | autolink link |lists | charmap | code | removeformat',
        setup : function(ed) {      
        ed.on('change', function (e) {	
          generateCode();
          });	
        /*ed.on('init', function(e){
          if (tinymce.get('tinyMCEimage').getContent() == ''){
          tinymce.get('tinyMCEimage').setContent("<p id='#imThePlaceholder' style='opacity:0.6'>[Placeholder for image context. The content you entered in step 2 will appear here.]</p>");
          }
        });
        //and remove it on focus
        ed.on('focus',function(e){
            $('iframe').contents().find('#imThePlaceholder').remove();
        })*/			
      }
    });
    
   	/*These different options have been absorbed into a javascript Object allowing a direct mapping and lookup of code to icon name*/
	
    function iconpreview() {
        var faIcon = document.getElementById('faCode').value;
        var iconNames = {
			      "1":"fa-picture-o",
            "2":"play",
            "3":"eye" ,
            "4":"camera"
        }

        var iconName = iconNames[faIcon];
	     	var faIconCode = "<i id=\"icon\" class=\"fa fa-"+iconName+"\"></i> ";
		
        if (faIcon == "noI"){
          faIconCode = "";
          if (document.getElementById("icon"))
           {
            var icon = document.getElementById("icon");
            icon.parentNode.removeChild(icon);
            var iconpreview = document.getElementById("iconpreview");
            iconpreview.style.display = "none";
           }
        }

        else{
          if (document.getElementById("icon"))
          {
            var icon = document.getElementById("icon");
            icon.parentNode.removeChild(icon);
          }

          var code = document.createElement("span");
          code.innerHTML = faIconCode;
          var iconpreview = document.getElementById("iconpreview");
          iconpreview.style.display = "block";
          iconpreview.parentNode.insertBefore(code,iconpreview.nextSibling);
        }
        generateCode();
      }

    function copyCode(){
      /*REQUIRED FOR HISTORY*/
	  addToHistory(classImage)
	  /*END REQUIRED FOR HISTORY*/
	  SelectAll("txtarearespImg");
    }

    var contextCode;

    /*Function to generate and copy code for the responsive image*/
    function generateCode() {
        // Get the HTML contents of the currently active editor
	//console.debug(tinyMCE.activeEditor.getContent());

        if (document.getElementById('respImgSwitch').value !== ""){
        url = document.getElementById('respImgSwitch').value;
        }
        else{
        url = "https://drive.google.com/uc?id=1Tel_KpnwCcoRUMdMFyw-GJ-_MaqeaWYZ&export=download";
        }

	contextCode = getTinyContent('tinyMCEimage',"[Placeholder for image context. This will update as you change the information on the page.]")

	var imgHeading = $('#respImgHeading').val();
	var imgWidth = getRadioOption("imageWidth");
	var imgPosition = getRadioOption("imagePosition");
	var headSize = getRadioOption("headSize")
	var faIcon = getRadioOption("faCode")

	classImage.link = url
	classImage.context = contextCode
	classImage.position = imgPosition
	classImage.width = imgWidth
	classImage.heading = imgHeading
	classImage.size = headSize
	classImage.icon = faIcon

	var rowOpen="<div class=\"row w-100\">"
	var firstCol="<div class=\"col-lg\">"
	var imgTagMake = function (src){return '<img class="img-fluid" src="'+src+'">'}
	var secCol="<div class=\"col-lg mt-2\">"
	var closeCol="</div>"
	var closeRow="</div></div>"
	
	var iconNames = {
		"1":"image",
		"2":"play",
		"3":"eye" ,
		"4":"camera"
	}

	var iconName = iconNames[faIcon];
		var faIconCode = "<i class=\"fa fa-"+iconName+"\"></i> ";
	
	if (faIcon == "noI"){
		faIconCode = "";
	}  

	var resizedHead;  
    
	//Resizing the heading text
	hTag = "<"+headSize+">"
	hTagClose = "</"+headSize+">"
	resizedHead = ((headSize == "noH") ? "" : hTag+faIconCode+imgHeading+hTagClose) 
    
       if(resizedHead == ""){
          $("#headSizeNone").prop("checked", true);
       }

      else{
            //Resizing the heading text
            
        switch(headSize){
          case "noH":
            resizedHead = "";
            break
          case "h3":
            resizedHead = head_3+faIconCode+imgHeading+endHead_3;
            break;
          case "h4":
            resizedHead = head_4+faIconCode+imgHeading+endHead_4;
            break;
          case "h5":
            resizedHead = head_5+faIconCode+imgHeading+endHead_5;
            break;
        }
  
      }
    

    
        //Change size of column if requested
        if (imgWidth == "33" && imgPosition == "left"){
          firstCol=firstCol4;
        }
        else if (imgWidth == "33" && imgPosition== "right"){
          secCol=secCol4;
        }
        else if (imgWidth == "25" && imgPosition== "left"){
          firstCol=firstCol3;
        }
        else if (imgWidth == "25" && imgPosition== "right"){
          secCol=secCol3;
        }

          if (url !== imageplaceholder)
          {
          }
          else
          {
            url = imageplaceholder;
          }

        if (imgPosition == "left"){
            //var textOutput = resizedHead+respImg_1+respImg_2r+url+respImg_3r+respImg_4+contextCode+respImg_5;
            var textOutput = resizedHead+rowOpen+firstCol+imgTag+url+closeCol+secCol+contextCode+closeRow;
        }
        else if (imgPosition == "right"){
            //var textOutput = resizedHead+respImg_1+contextCode+respImg_2+url+respImg_3;
            var textOutput = resizedHead+rowOpen+firstCol+contextCode+closeCol_r+secCol+imgTag+url+closeRow_r;
        }

        document.getElementById('txtarearespImg').innerHTML=textOutput;
        //SelectAll("txtarearespImg");
         //Add the html code after the div
		    var demoDiv = document.getElementById("demo");
		    demoDiv.innerHTML = textOutput;
        }

      //var textarea = $('#respImgHeading');
      //var select = $('#headSize');
      //var addOrRemoveRequiredAttribute = function () {
      //if (textarea.val().length) {
      //  select.val("h5")
     // }
      //};

      // Run now
     // addOrRemoveRequiredAttribute();

      // And when textarea changes
    //  textarea.on('change', addOrRemoveRequiredAttribute);

    function SelectAll(id){
        document.getElementById(id).focus();
        document.getElementById(id).select();
        document.execCommand("copy");
        var popup = document.getElementById("myPopup");
        popup.classList.toggle("showPopup");
    }
 

    function submitform()
    {
        document.forms["myform"].submit();
    }
    $(function () {
  $('[data-toggle="tooltip"]').tooltip()
});

  </script>
  <!-- Load the Google API Loader script. -->
  <script type="text/javascript" src="https://apis.google.com/js/api.js?onload=onApiLoad"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>

  <script src="js/drive-controller.js"></script>
  <script src="js/gapi-auth-service.js"></script>
  <script src="js/drive-service.js"></script>
  <script>
  window.onload=function(){
    generateCode();
    function activeNav() {
      var pgurl = window.location.href.substr(window.location.href.lastIndexOf("/")+1);
           $(".nav-link").each(function(){
                if($(this).attr("href") == pgurl || $(this).attr("href") == '' ){
                $(this).addClass("active");
                $(this).removeClass("text-white");
                $(this).append('<span class="sr-only">(current)</span>');
                $(this).closest('.nav-item').css({"background": "#004DAE"});
           }
          });
      }
      setTimeout(function() {
          activeNav();
      }, 100);
    };
  </script>
  <style>
    .mce-notification-inner, .mce-close, .mce-notification-warning {
    display:none !important;
    }
    .tooltip-inner {
      text-align: left;
      padding: 15px;
      font-size: 1.05rem;
      max-width: 400px;
    }
    .nav-item:hover {
  background: #004dae;
}
    </style> 
</head>
<body>
<div id="beestNav">
</div>
  <div class="py-5"></div>
<div class="container-fluid">
<h3 class="text-center font-weight-bold">Responsive image + context<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Upload an image from one of the listed platforms and input some context or text around the image. Then choose the size of the image, and which side of the screen you would like it on." class="hideableinstruct text-success small">&nbsp;<i class="fa fa-question-circle"></i></h3>
<h5 class="text-center"><a class="hideableinstruct" data-toggle="modal" data-target=".respImgWalkthrough" href="">Create a responsive image & context walkthrough</a></h5>
<!--Start of modal content-->
<!--Responsive image walkthrough modal-->
<div class="modal fade respImgWalkthrough" tabindex="-1" role="dialog" aria-labelledby="panopto-modal" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content p-2 bg-dark">
      <div class="modal-header">
        <h5 class="modal-title text-white" id="exampleModalLabel">Click close or click outside this box to return to the BEEST.</h5>
          <button type="button" class="btn btn-outline-light btn-lg ml-2" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">Close &times;</span>
          </button>
      </div>
      <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=cef099bc-a7e9-4211-be3c-ac3e005c0924"></iframe></div>
    </div>
  </div>
</div>
<!--How to paste HTML into Moodle modal-->
<div class="modal fade html-paste-modal mt-5" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content p-2 bg-dark">
      <div class="modal-header">
        <h5 class="modal-title text-white">Click close or click outside this box to return to the BEEST.</h5>
        <button type="button" class="btn btn-outline-light btn-lg ml-2" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">Close &times;</span>
        </button>
      </div>
    <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=d1c0ffaa-23a4-4d38-bb49-abda00b7805a"></iframe>
    </div>
    </div>
  </div>
</div>
<!--End of modal content for this page-->
<div class="row w-50 mx-auto text-center mt-2">
  <div class="col-lg mt-2">
        <a data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Click this button to clear the page and start again." href="javascript:window.location.reload()" class="btn btn-danger btn-lg btn-block" role="button">Clear the page <i class="fa fa-fw fa-refresh"></i></a>
      </div>
      <div class="col-lg mt-2">
        <button id="toggleHelp" data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus click" title="Click this button to toggle the help instructions on the page on/off. Only do this if you are completely familiar with how to use the page" onclick="flipTooltip()" class="btn btn-success btn-lg btn-block">Turn <span class="onoffswapinstr">off</span> help <i class="fa fa-fw fa-power-off"></i></a>
      </div></div>
        <!--<ul>
          <li><a data-toggle="modal" data-target=".unsplash-modal" href="">Unsplash</a>
            <div class="modal fade unsplash-modal" tabindex="-1" role="dialog" aria-labelledby="panopto-modal" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content p-2">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">To close this window click the button on the right or anywhere outside this box.</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
              <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=b84fa926-7531-4321-8f0b-ac2c0000d69d"></iframe></div>
              </div>
            </div>
          </div></li>
          <li><a data-toggle="modal" data-target=".pexels-modal" href="">Pexels</a>
            <div class="modal fade pexels-modal" tabindex="-1" role="dialog" aria-labelledby="youtube-modal" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content p-2">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">To close this window click the button on the right or anywhere outside this box.</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=98282461-8b14-48fb-a4d2-ac2c0000d672"></iframe></div>
                </div>
              </div>
            </div></li>
          <li><a data-toggle="modal" data-target=".stocksnap-modal" href="">StockSnap</a>
            <div class="modal fade stocksnap-modal" tabindex="-1" role="dialog" aria-labelledby="ted-modal" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content p-2">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">To close this window click the button on the right or anywhere outside this box.</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=d27cc54b-dd5e-4436-b862-ac2c0000d623"></iframe></div>
                </div>
              </div>
            </div></li>
        </ul>-->
        <hr class="hr-3">
<form id="respImg">   
   <div class="row w-100 mx-auto">
    <div class="col-lg-6 mt-2">
	<div class="row w-100 mx-auto">
        <div class="col-lg-3"> 
          <h5 class="font-weight-bold">Recover past data<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Recover recently created items. This will only become operational once you have created at least one item. If you change browsers or clear your browser history, you will lose this history as well." class="hideableinstruct text-success small">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
        </div>
        <div class="col-lg-8">
          <select class="custom-select border border-dark" size="1" id="recoveryDate" onchange="idSelectedRecData()">
            <option selected value=0>please wait</option>
            </select>
          </div>
          <div class="col-lg-1 text-center">
            <button id="delHist" onclick="delHistI()" type="button" class="btn btn-danger mr-2" data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Delete the currently selected historical data."><i class="fa fa-fw fa-trash"></i></button>
            <button id="loadHist" onclick="getHistoryI(histIndex,historicalData)" class="btn btn-mu d-none">Recover <i class="fa fa-fw fa-undo"></i></button>
        </div>
      </div>
      <hr>
    <div class="row w-100 mx-auto">
      <div class="col-lg-3">
        <h5 class="font-weight-bold">Link<span data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Paste in the link/URL (not the embed code) for your image." class="small text-success hideableinstruct">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
        </div>
        <div class="col-lg">
        <p>Find your image from <a href="https://unsplash.com" target="_blank">Unsplash</a> | <a href="https://www.pexels.com" target="_blank">Pexels</a> | <a href="https://stocksnap.io/" target="_blank">StockSnap</a></p>
        <!--<a data-toggle="modal" data-target=".panopto-modal" href="">search an image here</a>
            <div class="modal fade panopto-modal" tabindex="-1" role="dialog" aria-labelledby="panopto-modal" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content p-2">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">To close this window click the button on the right or anywhere outside this box.</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
              <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=b84fa926-7531-4321-8f0b-ac2c0000d69d"></iframe></div>
              </div>
            </div>
          </div>-->
          <textarea class="rounded p-2 w-100" rows="1" name="respImgSwitch" type="text" id="respImgSwitch" placeholder="Paste the Unsplash/Pexels/StockSnap image link here" onchange=generateCode()></textarea>
       <!-- <p id="popup"><span class="popuptext" id="myPopup">Please paste a valid link from Unsplash/Pexels/StockSnap</span></p>-->
        
        
        <div ng-controller="driveController">        
          <!--<div ng-show="checkingLogin">Checking login status...</div>
          Login status:{{loggedIn}}
          <button ng-disabled="checkingLogin || loggedIn" ng-click="login()">Log In</button>-->
        
          <div ng-show="loggedIn">
            <input ng-disabled="uploading" ng-click="clickFileUpload()" type="button" class="btn btn-arts m-1" name="uploadImage" value="Upload image" >
            <!--<button ng-disabled="uploading" ng-click="clickFileUpload()">Upload image</button>-->
            <input type="button" class="btn btn-arts m-1" name="uploadImage" value="Choose Image from Google Drive" onclick="loadPicker()">
            <!--<button onclick="loadPicker()">Choose Image from Google Drive</button>-->
            <input type="file" id="uploadImage" accept="image/*" onchange="angular.element(this).scope().upload()" style="display:none;">
            <div ng-show="uploading">Uploading image to your Google Drive ...</div>    
            <!--<div ng-show="!images.length">No uploaded images yet</div>-->
            <div ng-repeat="image in images" style="max-width:800px;max-height:800px;">
              <img id ="img2" ng-src="{{image}}" style="max-width: 100%;max-height: 100%;">
            </div>
          </div>
        </div>
      </div>
      </div>
          <hr>
    <div class="row w-100 mx-auto">
      <div class="col-lg-3">
        <h5 class="font-weight-bold">Context<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Giving the image some context helps users to understand what the image is trying to communicate. Or you can type text you would like to go alongside the image.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
       
      </div>
      <div class="col-lg">
            <textarea id="tinyMCEimage" class="border border-dark rounded p-2 w-100" cols="70" rows="3" name="respVid_context"></textarea>
    </div>
   </div>

      <!--<div class="col-lg-3">
        <h5 id="imagepreview" class="w-50" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" style="display:none;">Image Preview</h5>
        <img id="img" src="" style="max-width:100%;max-height:100%;">
      </div>-->

  <hr>
      <div class="row w-100 mx-auto">
        <div class="col-lg-3">
          <h5 class="font-weight-bold">Position<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose which side of screen you would prefer the image to appear on.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
          
          </div>
          <div class="col-lg">
                <!--<select class="custom-select border border-dark" id="imagePosition" name="imagePosition" size="1" onchange=generateCode()>
                <option value="right" selected>Image on the right</option>
                <option value="left">Image on the left</option>
              </select>-->
              <div class="form-check form-check-inline" id="imagePosition" onchange=generateCode()>
                <input class="form-check-input" name="imagePosition" id="imagePosition2" type="radio" value="left">
                <label class="form-check-label" for="imagePosition2">Left</label>
              </div>
              <div class="form-check form-check-inline" id="imagePosition" onchange=generateCode()>
                <input class="form-check-input" name="imagePosition" id="imagePosition1" type="radio" value="right" checked>
                <label class="form-check-label" for="imagePosition1">Right</label>
              </div>
              </div> 
            </div> 
<hr>
            <div class="row w-100 mx-auto">
              <div class="col-lg-3">
                <h5 class="font-weight-bold">Image width<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose whether you want the image to be 50% (1/2) of the screen width or 33.3% (1/3) of the screen width.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
                
              </div>
              <div class="col-lg">
                      <!--<select class="custom-select border border-dark" id="imageWidth" name="imageWidth" size="1" onchange=generateCode()>
                      <option value="50" selected>50% (1/2)</option>
                      <option value="33">33.3% (1/3)</option>
                      <option value="25">25% (1/4)</option>
                    </select>-->
                    <div class="form-check form-check-inline" id="imageWidth" onchange=generateCode()>
                      <input class="form-check-input" name="imageWidth" id="imageWidth1" type="radio" value="50" checked>
                      <label class="form-check-label" for="imageWidth1">50% (1/2)</label>
                    </div>
                    <div class="form-check form-check-inline" id="imageWidth" onchange=generateCode()>
                      <input class="form-check-input" name="imageWidth" id="imageWidth2" type="radio" value="33">
                      <label class="form-check-label" for="imageWidth2">33.3% (1/3)</label>
                    </div>
                    <div class="form-check form-check-inline" id="imageWidth" onchange=generateCode()>
                      <input class="form-check-input" name="imageWidth" id="imageWidth3" type="radio" value="25">
                      <label class="form-check-label" for="imageWidth3">25% (1/4)</label>
                    </div>
                    </div> 
                  </div> 
<hr>
            <div class="row w-100 mx-auto">
              <div class="col-lg-3">
                <h5 class="font-weight-bold">Heading<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Type the heading for this image. 50 character maximum. If you want a heading, you must also complete step 5 or your heading will not display.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
                </div>
                <div class="col-lg">
                <textarea maxlength="50" class="rounded p-2 w-100" rows="1" name="respVid_heading" type="text" id="respImgHeading" placeholder="Type your image heading here" onchange=generateCode()></textarea>
              </div>
            </div>
<hr>
    <div class="row w-100 mx-auto">
    <div class="col-lg-3">
      <h5 class="font-weight-bold">Heading size<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose the size of your heading. If you do not choose a heading size, your heading will not display.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
      
    </div>
    <div class="col-lg">
            <!--<select class="custom-select border border-dark" id="headSize" name="headSize" size="1" onchange=generateCode()>
            <option selected value="noH">No heading</option>
            <option selected value="h5">Small (heading 5)</option>
            <option value="h4">Medium (heading 4)</option>
            <option value="h3">Large (heading 3)</option>
          </select>-->
          <div class="form-check form-check-inline" id="headSize" onchange=generateCode()>
            <input class="form-check-input" name="headSize" id="headSizeNone" type="radio" value="noH" checked>
            <label class="form-check-label" for="headSizeNone">No heading</label>
          </div>
          <div class="form-check form-check-inline" id="headSize" onchange=generateCode()>
            <input class="form-check-input" name="headSize" id="headSize1" type="radio" value="h5">
            <label class="form-check-label" for="headSize1"><h5>Small</h5></label>
          </div>
          <div class="form-check form-check-inline" id="headSize" onchange=generateCode()>
            <input class="form-check-input" name="headSize" id="headSize2" type="radio" value="h4">
            <label class="form-check-label" for="headSize2"><h4>Medium</h4></label>
          </div>
          <div class="form-check form-check-inline" id="headSize" onchange=generateCode()>
            <input class="form-check-input" name="headSize" id="headSize3" type="radio" value="h3">
            <label class="form-check-label" for="headSize3"><h3>Large</h3></label>
          </div>
          </div> 
        </div>   
        <hr>
        <div class="row w-100 mx-auto">
          <div class="col-lg-3">
            <h5 class="font-weight-bold">Heading icon<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose an icon to go with your heading. If you want an icon, you must also write a heading and choose a heading size or the icon and heading will not display.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
            
            </div>
            <div class="col-lg">
            <!--<select class="custom-select border border-dark" id="faCode" name="faCode" size="1" onchange=generateCode()>
              <option selected value="noI">No icon</option>
                <option value="1">Image</option>
                <option value="2">Play</option>
                <option value="3">Eye</option>
              </select>-->
              <div class="form-check form-check-inline" id="faCode" onchange=generateCode()>
                <input class="form-check-input" name="faCode" id="faCodeNone" type="radio" value="noI" checked>
                <label class="form-check-label" for="faCodeNone">No icon</label>
              </div>
              <div class="form-check form-check-inline" id="faCode" onchange=generateCode()>
                <input class="form-check-input" name="faCode" id="faCode1" type="radio" value="1">
                <label class="form-check-label" for="faCode1"><i class="fa fa-picture-o fa-2x"></i></label>
              </div>
              <div class="form-check form-check-inline" id="faCode" onchange=generateCode()>
                <input class="form-check-input" name="faCode" id="faCode2" type="radio" value="2">
                <label class="form-check-label" for="faCode2"><i class="fa fa-play fa-2x"></i></label>
              </div>
              <div class="form-check form-check-inline" id="faCode" onchange=generateCode()>
                <input class="form-check-input" name="faCode" id="faCode3" type="radio" value="3">
                <label class="form-check-label" for="faCode3"><i class="fa fa-eye fa-2x"></i></label>
              </div>
              <div class="form-check form-check-inline" id="faCode" onchange=generateCode()>
                <input class="form-check-input" name="faCode" id="faCode4" type="radio" value="4">
                <label class="form-check-label" for="faCode4"><i class="fa fa-camera fa-2x"></i></label>
              </div>
            </div>
            </div>
          </div> 
          
<div class="col-lg-6 mt-2">
  <div class="sticky-top" style="top:100px;">
            <h5 class="font-weight-bold">Preview<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="A preview of your element will appear here as you update your preferences on the page.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
          <div id="demo" class="row w-100 mb-3 mx-auto">                     
          </div>
          <hr>
       <h5 class="font-weight-bold">Copy code<span class="small text-success hideableinstruct" data-toggle="tooltip" data-placement="right" data-trigger="focus hover" title="Click this button to copy the code for your element ready for pasting in Moodle.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
       
       
        <textarea readonly class="rounded p-2 w-100 mt-2" id="txtarearespImg" cols="70" rows="3" name="Result" placeholder="Code for your element will appear here"></textarea>
        <input type="button" class="btn btn-lg btn-block btn-success mt-3" id="copyCodeBtn" name="GenerateWrap" value="Copy your code </>" onClick=copyCode() data-toggle="tooltip" data-placement="top" data-trigger="click focus" title="Your code has been copied." />
        <div class="text-center h5 mt-4">
          <a data-toggle="modal" data-target=".html-paste-modal" href="#">How do I paste this into Moodle?</a>
          </div>
        
        <!--<input type="button" class="btn btn-arts m-1" name="GenerateWrap" value="Write back to Moodle" onClick=writeinMoodle() >-->
    
      </div>
    </div>
    </form>

    <p class="my-3"></p>
  </div>

<script src="https://apis.google.com/js/client.js?onload=gapiLoaded"></script>
<script type="text/javascript" src="https://apis.google.com/js/api.js"></script>

<script>
    $('#respImgSwitch').on('input', function(event) {
    var s = $('#respImgSwitch').val().toString();

    if (s.includes("unsplash.com") == true) {
    //code for replacing unplash link with embed code
    var x = s.replace('https://unsplash.com/photos','https://source.unsplash.com');
    }

    else if (s.includes("pexels.com") == true) {
    //code for replacing stocksnap link with embed code
    var y = s.replace('https://www.pexels.com/photo/','');
    var x = y.replace('/','');
    //use regular expression to find the id number
    var pexelsid = x.match(/\d+/)[0];
    var x = "https://images.pexels.com/photos/" + pexelsid + "/pexels-photo-" + pexelsid + ".jpeg";
    }

    else if (s.includes("stocksnap.io") == true) {
    //code for replacing unplash link with embed code
    var y = s.replace('https://stocksnap.io/photo/','https://cdn.stocksnap.io/img-thumbs/960w/');
    //use regular expression to convert the last - to _
    var x = y.replace(/-([^-]*)$/,'_$1') + ".jpg"
    }

    else{
    var popup2 = document.getElementById("myPopup2");
    popup2.classList.toggle("showPopup");
    }

    $('#respImgSwitch').val(x);
    //$('input[type="text"], textarea#respVidSwitch').attr('readonly','readonly');
  }); 
</script>
<script>var textarea = $("#respImgHeading");
  var radioBtn = $("#headSize1");
  var checkRadio = function(){
      if (textarea.val().length) {
        $("#headSize1").prop("checked", true);
        generateCode();
      };
  };
  // Run now
  // And when textarea changes
  textarea.on("change", checkRadio);
  </script>
<script>
  $(function () {
    $(document).on('shown.bs.tooltip', function (e) {
       setTimeout(function () {
         $(e.target).tooltip('hide');
       }, 10000);
    });
  });</script>
  <script>
    $(function () {
      $('#copyCodeBtn').on('click', function (e) {
         setTimeout(function () {
           $(e.target).tooltip('hide');
         }, 2500);
      });
    });
    $(function () {
      $('#toggleHelp').on('click', function (e) {
         setTimeout(function () {
           $(e.target).tooltip('hide');
         }, 2500);
      });
    });
    </script>
    <script>
           var textarea = $("#respImgHeading");
   //     var radioBtn = $("#headSize2");
   var checkRadio = function(){
          if (textarea.val()!=="") {
            $("#headSize1").prop("checked", true);
            generateCode();
            }
          else {
            $("#headSizeNone").prop("checked", true);
            generateCode();
            } 
                };
              // And when textarea changes
              textarea.on("change", checkRadio);
              </script>
     <div class="py-5"></div>
</div>
<div id="beestFooter"></div>
</body>
</html>