<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-152392632-3"></script>
<script src = "js/helperFunctions.js"></script>
<script src="js/pageHistory.js"></script>
<script src="js/setupPage.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="A simple element creator to generate responsive code that can be easily embbedded into Moodle">
    <meta name="author" content="T&M">
      <title>BEEST Accordion</title>
      <link rel="icon" href="img/black favicon-16x16.png" type="image/gif">
      <!-- external link to css file --> 
      <!-- Bootstrap CSS -->   
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
      <!-- Arts CSS -->  
      <link rel="stylesheet" href="css/adminPlusSetuBlockStyle.css" />
      <link rel="stylesheet" href="css/accordionStyle.css" />
      <link rel="stylesheet" href="css/monashElements.css" />
      <!-- external link to js file -->  
      <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
      <script src="  https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <!-- Bootstrap js file --> 
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
      <!-- FontAwesome js file --> 
      <script src="https://kit.fontawesome.com/3817feae52.js"></script> 
      <!-- Tinymce js file -->   
       <script src="https://beest.monash.edu/tinymce/tinymce.min.js"></script>
      <!-- TinyMCE placeholder plugin file -->
      <script src="js/placeholder.js"></script>
      <!--<script src="js/insertCode.js"></script>-->


	    <script src="js/advancedModeLocalStorage.js"></script>
      <script type="text/javascript">
const START_ELEMENT = "<!--Begin BEEST accordion-->"
const END_ELEMENT = "<!--End BEEST accordion-->"

var iconNames = {
	"noI":"",
	"1":"database",
	"2":"question",
	"3":"question-circle",
	"4":"question-circle-o", 
	"5":"info",
	"6":"info-circle",
	"7":"exclamation",
	"8":"exclamation-triangle",
	"9":"exclamation-circle",
	"10":"life-ring"
}
/*REQUIRED FOR HISTORY*/	
	const ACCORD_HIST = "history_accordion"
	var localStorageHistory = ACCORD_HIST
/*END REQUIRED FOR HISTORY*/	
	const NULLHEADING = "~...N/A...~"
	const COUNTER_ID = "accordCounter"
	const absoluteMaxAccord = 10;
	const absoluteMinAccord = 3;
	var classAccord = null
	var accordiansPostInit = []

	$(document).ready(function() { //create the tinyMCE areas after the first
		setupGoogleAnalytics();
		setupNav();
		fullScreenToggle();
		setupToolTips();
		default_XRadio_onEmpty_Y("accMainHeading","headSize","noH","headSize2",generateElementCode);
		makeTinyWithID('tinyMCEmonAccContent1',{"change":generateElementCode},"enter your text for drawer 1 here");
		
		classAccord = new accordion()
		classAccord.addDrawer() //page starts with 1 drawer
		while (classAccord.usableDrawers < absoluteMinAccord){
			addSection()
		}
        //setupInsertCode();
		/*REQUIRED FOR HISTORY*/
		initHistory()
		/*END REQUIRED FOR HISTORY*/
		setupBackToTopButton()
	});
	/*REQUIRED FOR HISTORY*/
	class drawer{
		constructor(heading,content,pageHtml){
			this.heading=heading
			this.content=content
			this.pageHtml = pageHtml
		}
		toPDO(){
			return {
				mainHead:	this.heading,
				cont:		this.content,
				pageHtml: 	this.pageHtml
			}
		}
		toString(){return JSON.stringify(this.toPDO())}
		fromObj(PDO){
			this.heading = PDO.mainHead
			this.content = PDO.cont
			this.pageHtml = PDO.pageHtml
		}
	}
	
	class accordion{
		baseHead = "monAccBtnTxt"
		baseCont = "monAccContent"
		baseTiny = "tinyMCEmonAccContent"
		baseBlock = "AccordSect"
		
		constructor(mainHead,headSize,icon,drawerList,openClose,drawerSize,drawerColour,drawerBorder){
			this.mainHead = mainHead
			this.headSize = headSize
			this.icon = icon
			this.openClose = openClose
			this.drawerSize = drawerSize
			this.drawerColour = drawerColour
			this.drawerBorder = drawerBorder
			if (drawerList == undefined){
				this.drawerList = []
			}
			else{
				this.drawerList = drawerList
			}
			/*format of list is [{head,cont,template},...]*/
			this.drawerCount = this.drawerList.length
			this.usableDrawers = this.drawerCount
		}
		addDrawer(heading,content){
			if (this.usableDrawers == this.drawerCount){
				var htmlCode = this.accordianSectionTemplate(this.drawerCount+1)
				this.drawerList.push(
					new drawer(heading,content,htmlCode)
				);
				this.drawerCount++
			}
			this.usableDrawers++
		}
		getDrawerFull(index){
			if (!(this.validDrawer(index))){
				console.error("drawer out of bounds")
				return null
			}
			else{
				return this.drawerList[index]
			}
		}
		getDrHead(index){return this.getDrawerFull(index).heading}
		getDrCont(index){return this.getDrawerFull(index).content}
		getAllDrawers(){
			var result = []
			for (var drI=0;drI < this.usableDrawers; drI++){
				result.push(this.getDrawer(drI))
			}
			return result
		}
		getDrawer(index){
			return this.getDrawerFull(index).pageHtml
		}
		getLastDrawer(){
			return this.getDrawer(this.usableDrawers-1)
		}
		removeDrawer(){
			this.usableDrawers--
			if (this.usableDrawers<=0){
				this.usableDrawers = 0
			}
		}
		setDrawerData(index,heading,content){
			if (this.validDrawer(index)){
				this.drawerList[index].heading = heading
				this.drawerList[index].content = content
			}
			else{
				console.error("cannot set data for drawer "+index+": out of bounds")
			}
		}
		validDrawer(index){
			return (index<=this.usableDrawers)||(index >= 0)
		}
		toPDO(){
			var result = {}
			result.mainHead = this.mainHead
			result.headSize = this.headSize
			result.icon = this.icon
			result.drawerList = []
			for (var d=0; d<this.usableDrawers; d++){
				result.drawerList.push(
					this.drawerList[d].toPDO()
				)
			}
			result.openClose = this.openClose
			result.drawerCount = this.usableDrawers
			result.drawerSize = this.drawerSize
			result.drawerColour = this.drawerColour
			result.drawerBorder = this.drawerBorder
			return result
		}
		toString(){return JSON.stringify(this.toPDO())}
		fromObj(PDO){
			this.mainHead = PDO.mainHead
			this.headSize = PDO.headSize
			this.icon = PDO.icon
			this.openClose = PDO.openClose
			for (var dr=0; dr < PDO.drawerCount; dr++){
				var theDrawer = PDO.drawerList[dr]
				this.addDrawer(theDrawer.heading,theDrawer.content)
			}
			this.drawerColour = PDO.drawerColour
			this.drawerBorder = PDO.drawerBorder
			this.drawerSize = PDO.drawerSize
		}
		accordianSectionTemplate(num){
			var idHead = this.baseHead+num
			var idCont = this.baseCont+num
			var idTiny = this.baseTiny+num
			var idBlock = this.baseBlock+num
			
			var headingHTML="<span id=\""+idBlock+"\"><div class=\"row w-100\"><div class=\"col-lg\"><h6>Heading "+num+"</h6><textarea maxlength=\"75\" class=\"border border-dark rounded p-2 w-100 mx-auto\" rows=\"1\" placeholder=\"Input the heading for drawer "+num+" here\" id=\""+idHead+"\" onchange=generateElementCode()></textarea></div></div>"
			
			var contentHTML = "<div class=\"row w-100 mt-2\"><div class=\"col-lg\"><h6>Content "+num+"</h6><textarea id=\""+idTiny+"\"class=\"border border-dark rounded p-2 w-100\" rows=\"3\" name=\""+idCont+"\" placeholder=\"Write the content for drawer "+num+" here\" onchange=generateElementCode()></textarea></div></div><hr></span>"
			
			return {
				IDHead: idHead,
				IDTiny: idTiny,
				IDCont: idCont,
				IDBlock: idBlock,
				output: headingHTML+contentHTML
			}
		}
	}
	/*END REQUIRED FOR HISTORY*/

	function add_remove_drawers_to_match_count(new_count){
		while (classAccord.usableDrawers < new_count){
			addSection()
		}
		while (classAccord.usableDrawers > new_count){
			removeSection()
		}
	}
	
	function changeDrawerCount(){
		var revisedCount = document.getElementById(COUNTER_ID).value
		if (isNaN(revisedCount)){
			revisedCount = classAccord.usableDrawers
		}
		else{
			if (!(Number.isInteger(revisedCount))){
				revisedCount = Number.parseInt(revisedCount)
			}
			if (revisedCount > absoluteMaxAccord){
				revisedCount = absoluteMaxAccord
			}
			if (revisedCount < absoluteMinAccord){
				revisedCount = absoluteMinAccord
			}
			add_remove_drawers_to_match_count(revisedCount)
		}
		updatePageCounter(revisedCount)
	}
	
	function updatePageCounter(currCounter){
		document.getElementById(COUNTER_ID).value = currCounter;
	}

	function addSection(live){
	/*
	use the template to construct a new one (or show existing)
	(maximum absoluteMaxAccord sections)
	*/	
		var newSection = classAccord.usableDrawers+1
		if (newSection > absoluteMaxAccord){
			alert("maximum accordion sections reached") //just in case button is still clicked despite being hidden
			return
		}
		if (classAccord.usableDrawers >= classAccord.drawerCount){
			classAccord.addDrawer()
			var newAccordian = classAccord.getLastDrawer()
		
			var newArea = document.getElementById("newAccordArea")
			newArea.insertAdjacentHTML('beforeend', newAccordian.output)
			
			makeTinyWithID(newAccordian.IDTiny,{"change":generateElementCode},"enter your text for drawer "+classAccord.usableDrawers+" here")
			
			//accordianSectionsTotalMade+=1;
		}
		else{
			classAccord.addDrawer()
			var accordAppear = classAccord.getLastDrawer()
			showHTML(accordAppear.IDBlock)
		}
		updatePageCounter(classAccord.usableDrawers)
				
		resetAddRemoveButtonDisplay()
    generateElementCode();
	if ((live!=undefined)&&(live)){
		if ((classAccord.getDrCont(classAccord.usableDrawers-2)!="")||(classAccord.getDrHead(classAccord.usableDrawers-2)!="")){		
			var revealedAccord = classAccord.getLastDrawer()
			scrollTo(revealedAccord.IDBlock);
		}
	}
	
	
  }
  
function resetAddRemoveButtonDisplay(){
	if (classAccord.usableDrawers >= absoluteMaxAccord){
		disableButton("plusbutton")
	}
	else{
		enableButton("plusbutton");
	}
	if (classAccord.usableDrawers > absoluteMinAccord){
		enableButton("minusbutton")
	}
	else{
		disableButton("minusbutton")
	}
}
  
	function removeSection(){
	/*
	hide an existing one (minimum absoluteMinAccord sections)
	TBC change arrays at end
	*/
		if (classAccord.usableDrawers <= absoluteMinAccord){
			alert("minimum accordion sections reached") //just in case button is still clicked despite being hidden
			return
		}
	
		var accordAppear = classAccord.getLastDrawer()
		hideHTML(accordAppear.IDBlock)
	
		classAccord.removeDrawer()
		updatePageCounter(classAccord.usableDrawers)		
		
		resetAddRemoveButtonDisplay()
    generateElementCode();
	}
	
	function accordListToIDs(accordList){
		/*format of accordList {
			IDHead: idHead,
			IDTiny: idTiny,
			IDCont: idCont,
			IDBlock: idBlock,
			output: headingHTML+contentHTML
		}*/
		var output = {btn: [], tiny: [], length:0};
		for (var accordNum=0; accordNum<accordList.length; accordNum++){
			output.btn.push(accordList[accordNum].IDHead)
			output.tiny.push(accordList[accordNum].IDTiny)
			output.length++;
		}
		return output
	}

function setAccordContentsAndHeadings(idList,dataSet){
	function getValAt(valType,dataSet,idNum){
		var method = {"contents":"getDrCont","heading":"getDrHead"}
		try{
			thisThing=dataSet[method[valType]](idNum)
		}
		catch{
			thisThing = ""
		}
		return thisThing
	}
	var thisContent;
	var thisHeading;
	for (var idNum=0; idNum<idList.length; idNum++){
		thisContent = getValAt("contents",dataSet,idNum)
		thisHeading = getValAt("heading",dataSet,idNum)
		tinyMCE.get(idList.tiny[idNum]).setContent(thisContent)
		document.getElementById(idList.btn[idNum]).value = thisHeading
	}
}
	
	function setTextAreas(dataSet){
	/*
	dataSet should be an instance of the accordion class
	*/
		const MONASH_BLUE_DRAWER_COLOUR_CODE = "heading-mu text-white,cardborder-mu"
		const DEFAULT_DRAWER_SIZE = "h5"
		
		idList = accordListToIDs(dataSet.getAllDrawers())
		document.getElementById('accMainHeading').value = dataSet.mainHead;
		if (dataSet.headSize!==undefined){
			setRadios('headSize',dataSet.headSize)
		}
		if (dataSet.icon!==undefined){
			setRadios('faCode',dataSet.icon)
		}
		if (dataSet.openClose!==undefined){
			setRadios('openClose',dataSet.openClose)
		}
		var bgStyleVal = MONASH_BLUE_DRAWER_COLOUR_CODE
		if (dataSet.drawerColour!==undefined){
			bgStyleVal = dataSet.drawerColour+","+dataSet.drawerBorder
		}
		setRadios('bgStyle',bgStyleVal)
		
		var drawerSizeVal = DEFAULT_DRAWER_SIZE
		if (dataSet.drawerSize!==undefined){
			drawerSizeVal = dataSet.drawerSize
		}
		setRadios('drawerSize',drawerSizeVal)

		add_remove_drawers_to_match_count(dataSet.drawerCount)
/*		
		tinyMCE.get('tinyMCEmonAccContent1').setContent(dataSet.getDrCont(0))
		document.getElementById('monAccBtnTxt1').value = dataSet.getDrHead(0)
	*/	
		setAccordContentsAndHeadings(idList,dataSet)			
	}
	
	function getTextAreas(idList){
		/*(var monAccContent1 = tinyMCE.get('tinyMCEmonAccContent1').getContent();
		var monAccBtnTxt1 = document.getElementById('monAccBtnTxt1').value;()*/
		var monAccCont = []
		var monAccBtn = []
		
		for (var idNum=0; idNum<idList.length; idNum++){
			monAccCont.push(tinyMCE.get(idList.tiny[idNum]).getContent())
			monAccBtn.push(document.getElementById(idList.btn[idNum]).value)
		}		
		return {cont: monAccCont, btn: monAccBtn, length:idList.length}
	}
	
	function updateClassInstanceWithPageData(classInst,IDs,txtAreas){
		start = 0
		end = classInst.usableDrawers
		var thisDrawer = null
		for (var idI = 0; idI < IDs.length; idI++){
			setHead = txtAreas.btn[idI]
			setCont = txtAreas.cont[idI]
			setId = IDs.btn[idI]
			for (var accId=start;accId < end; accId++){
				thisDrawer = classInst.getDrawerFull(accId)
				if (thisDrawer.pageHtml.IDHead==setId){
					thisDrawer.heading = setHead
					thisDrawer.content = setCont
					if (accId == start){start = accId+1}
					else if (accId == end-1){end = accId}
					break;
				}
			}
		}
	}
/*START helper functions for generate Element code*/	
function generateHeading(classAccord){
	//icon names moved to top
	var faIconCode = ""
	if (classAccord.icon != "noI"){
	  faIconCode = "<i class=\"fa fa-"+iconNames[classAccord.icon]+"\"></i> ";
	}
	var resizedHead=""
	if (classAccord.headSize != "noH"){
		var sizes = {"h3":3,"h4":4,"h5":5}
		resizedHead = '<h'+sizes[classAccord.headSize]+'>'+faIconCode+classAccord.mainHead+"</h"+sizes[classAccord.headSize]+">"
	}
	else{
		resizedHead = "<h5 hidden>"+NULLHEADING+"</h5>"
	}
	return resizedHead
}

function generateAccordionHTML(classAccord,resizedHead,monAccBtnTxt,monAccContent,openClosed,drawerSize,drawerStyle){
//generate a random string start to ensure no accordions mix each other up
	var monAccOutput = resizedHead
	
	var randString = randomString(5)
	
	var numCode = null
	var lastDr = classAccord.usableDrawers - 1
	
	changesByDrawer = {"beestAccUse":"","roundTop":"","showhide":"","roundBottom":"","roundNone":""}
	var textColourClass = " text-black"
	if (classAccord.drawerColour.search("white")>0){
		textColourClass = " text-white"
	}
	else if (classAccord.drawerColour.search("black")>0){
		textColourClass = " text-black"
	}
	else if (classAccord.drawerColour.search("bold")>0){
		textColourClass = " text-bold"
	}
	
	// loop over every accordion block
	for (var secNum = 0; secNum < classAccord.usableDrawers; secNum++){
		changesByDrawer.beestAccUse = ((secNum==0) ? " beestAcc" : "")
		changesByDrawer.roundTop = ((secNum==0) ? " rounded-top " : " rounded-0 ")
		if (openClosed=="closed"){
			changesByDrawer.showhide = ""
		}
		else{
			changesByDrawer.showhide = ((secNum==0) ? "show " : "")
		}
		changesByDrawer.roundBottom = ((secNum==lastDr) ? " rounded-bottom " : "")
		
		
		numCode = randString+(1+secNum)
		monAccOutput += "<div id=\"accordion" + randString
		monAccOutput += "\" class=\"mt-0 w-100 mx-auto"+changesByDrawer.beestAccUse+"\"><div class=\"card border-0\"><div class=\""+changesByDrawer.roundTop+classAccord.drawerColour+" card-header p-0\" id=\"head" + numCode
		monAccOutput += "\" data-toggle=\"collapse\" data-target=\"#content" + numCode
		monAccOutput += "\" aria-expanded=\"false\" aria-controls=\"content" + numCode
		monAccOutput += "\"><"+classAccord.drawerSize+" class=\"mb-0 text-center\"><button class=\"noUnderline "+textColourClass+" btn btn-link\" data-toggle=\"collapse\" data-target=\"#content" + numCode
		monAccOutput += "\" aria-expanded=\"true\" aria-controls=\"content" + numCode
		monAccOutput += "\"><span class=\""+classAccord.drawerSize+textColourClass+"\">"
		
		monAccOutput += monAccBtnTxt[secNum]
		
		monAccOutput += "</span></button></"+classAccord.drawerSize+"></div><div id=\"content" + numCode
		monAccOutput += "\" class=\"collapse "+changesByDrawer.showhide+classAccord.drawerBorder+changesByDrawer.roundBottom+"\" aria-labelledby=\"head" + numCode
		monAccOutput += "\" data-parent=\"#accordion" + randString + "\"><div class=\"card-body p-1\"><div class=\"m-1 p-1\"><div class=\"accDiv\">"
		
		monAccOutput += monAccContent[secNum]
		monAccOutput += "</div></div></div></div></div>"
	} 
	
	monAccOutput+="</div></div></div>"
	
	return monAccOutput
}
		
/*END helper functions for generate Element code*/		
	function generateElementCode() {
		var IDs = accordListToIDs(classAccord.getAllDrawers())
		var txtAreas = getTextAreas(IDs)
			monAccBtnTxt = txtAreas.btn;
			monAccContent = txtAreas.cont;
		updateClassInstanceWithPageData(classAccord,IDs,txtAreas)
		classAccord.mainHead = document.getElementById('accMainHeading').value;
		classAccord.headSize = getRadioOption('headSize')
		classAccord.icon = getRadioOption('faCode')
		classAccord.openClose = getRadioOption('openClose')
		var drawerColouring = getRadioOption('bgStyle').split(",") //pos 0 is the main colouring and 1 is the border
		classAccord.drawerColour = drawerColouring[0]
		classAccord.drawerBorder = drawerColouring[1]
		classAccord.drawerSize = getRadioOption('drawerSize')
		
		var resizedHead = generateHeading(classAccord)
			//Resizing the heading text
			
		
		var monAccOutput = generateAccordionHTML(classAccord,resizedHead,monAccBtnTxt,monAccContent,classAccord.openClose,classAccord.drawerSize,classAccord.drawerColour);	
		
        document.getElementById('monAccCode').innerHTML=START_ELEMENT+monAccStyle+monAccOutput+END_ELEMENT;
        //SelectAll("monAccCode");
     //   $('#demo').nextAll('div.beestAcc, script, h3, h4, h5, i').remove();
		$('#demo').html(monAccOutput);
    }

/*REQUIRED FOR HISTORY*/
function getHistoryI(index,history){
	var selectedAccordion = history[index]
	refToClassAccord = new accordion()
	refToClassAccord.fromObj(selectedAccordion) // classAccord now holds the data of this index
	
	setTextAreas(refToClassAccord)
	classAccord = refToClassAccord
	generateElementCode()
}
/*END REQUIRED FOR HISTORY*/

function getColourBorderSize(divList){
	//set default value if none found
	var colBorSiz = {
		"colour":"heading-mu text-white",
		"border":"cardborder-mu",
		"size":"h5",
	}
	
	var colourBorderClassNames = {
		"heading-mu text-white":"cardborder-mu",
		"heading-sc text-black":"cardborder-sc",
		"heading-pm text-black":"cardborder-pm",
		"heading-dk text-white":"cardborder-dk"
	}
	var colourType = null;
	var colouredDiv = null
	var divI = 0
	while ((colourType == null) && (divI < divList.length)){
		for (var colourClass in colourBorderClassNames){
			if($(divList[divI]).hasClass(colourClass)){
				colourType = colourClass
				colouredDiv = divList[divI]
				break;
			}
		}
		divI++
	}
	//by the end colouredDiv / colourType will either still be null (in which case assume h5 and monash blue) otherwise it will have the first div and colour class found
	if (colourType !== null){
		colBorSiz.colour = colourType
		colBorSiz.border = colourBorderClassNames[colourType]
		if ($(colouredDiv).find("h3").length>0){
			colBorSiz.size = "h3"
		}
		else if ($(colouredDiv).find("h4").length>0){
			colBorSiz.size = "h4"
		}
		else{
			colBorSiz.size = "h5"
		}
	}
	
	return colBorSiz
}

function recoverCode(){
	_classAccord_ = new accordion()
	var pastedHTML = $("#retrieveCode").val()


    if(pastedHTML==="")return;
    let pastedHTMLArray=checkForMultipleBlocks(pastedHTML,"accordion"); //find the first block that matches the type (helperFunctions.js)
    if(pastedHTMLArray.length>0)pastedHTML=pastedHTMLArray[0]; //if the array has something in it use it, otherwise try with pastedHTML (in case the user does not paste the comments or breaks the string in some other way - may as well try to get something from it)

	
	var iconHeading = getIconAndHeading(pastedHTML)
	var iconClassName = iconHeading.iconName
	var headSize = iconHeading.headSize
	var headText = iconHeading.headText
	
	if (headText === NULLHEADING){
		_classAccord_.mainHead = ""
		_classAccord_.headSize = "noH"
	}
	else{
		_classAccord_.mainHead = headText
		_classAccord_.headSize = headSize
	}
	if (iconClassName == null){
		_classAccord_.icon = "noI"
	}
	else{
		var iconCode = reverseObjectMap(iconNames)
		_classAccord_.icon = iconCode[iconClassName]
	}
	var dataToFind = {
		tags:["button","div"],
		classes:["show","accDiv"]
	} //spans in order should give headings, div in order (when id starts with content) will give contents
	var recoveredData = recoverFromPasted(pastedHTML,dataToFind)
	var openClose = "closed"
	if (recoveredData.classes.hasOwnProperty("show")){
		openClose = "open"
	}
	_classAccord_.openClose = openClose
	var drawers = {head:[],cont:[]}
	
	drawers.cont = recoveredData.classes.accDiv
	drawers.head = recoveredData.tags.button
	for (var c=0;c<drawers.cont.length;c++){
		drawers.head[c] = $(drawers.head[c]).text()
		drawers.cont[c] = $(drawers.cont[c]).html()
		
		_classAccord_.addDrawer(drawers.head[c],drawers.cont[c])
	}
	
	var divList = recoveredData.tags.div
	var colBorSiz = getColourBorderSize(divList)
	_classAccord_.drawerColour = colBorSiz.colour
	_classAccord_.drawerBorder = colBorSiz.border
	_classAccord_.drawerSize = colBorSiz.size
	
	setTextAreas(_classAccord_)
	
	classAccord = _classAccord_
	generateElementCode()
}

    function copyCode(){
      SelectAll("monAccCode");
	  /*REQUIRED FOR HISTORY*/
	  addToHistory(classAccord)
	  /*END REQUIRED FOR HISTORY*/
    }
    // function to insert generated code
    function insertCode(){
        /*REQUIRED FOR HISTORY*/
        addToHistory(classAccord)
        /*END REQUIRED FOR HISTORY*/

        //insertCodeInPage("monAccCode");
        let obj={type:'monAccCode',code:$("#monAccCode").val()};
        //window.parent.postMessage(obj,"https://learning.monash.edu");
        window.parent.postMessage(obj,"*");
    }
        
    function SelectAll(id){
        document.getElementById(id).focus();
        document.getElementById(id).select();
        document.execCommand("copy");
    }

    function submitform()
    {
        document.forms["myform"].submit();
    }
    $(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
    /* Variable Key
    These variables are pre-defined html that is added to inputs from users before and after to generate the final html product for copying and pasting.
    monAcc = button to toggle extended text
    */
	  var monAccStyle="<script>var L=document.createElement('link'); L.rel='stylesheet'; L.href='https://mon-arts-ed-des.github.io/BEEST/css/accordionStyle.css'; document.getElementsByTagName('head')[0].appendChild(L);</scrip"+"t>"
	var monAccBtnTxt = [];
	var monAccContent = [];

function setupBackToTopButton(){
	$(window).scroll(function () {
		if ($(this).scrollTop() > 50) {
			$('#back-to-top').fadeIn();
		} else {
			$('#back-to-top').fadeOut();
		}
	});
	// scroll body to 0px on click
	$('#back-to-top').click(function () {
		$('body,html').animate({
			scrollTop: 0
		}, 400);
		return false;
	});
}
    </script>
    <style>
        .mce-notification-inner, .mce-close, .mce-notification-warning {
        display:none !important;
        }
        .tooltip-inner {
        text-align: left !important;
        padding: 15px !important;
        font-size: 1.05rem !important;
        max-width: 480px !important;
        }
        .nav-item:hover {
        background: #004dae;
        }
        .back-to-top {
    position: fixed;
    bottom: 100px;
    right: 50px;
    display: none;
    z-index: 2000;
}
    </style> 
    </head>
    <body>
<div id="beestNav"></div>
<div class="py-5"></div>
<div class="container-fluid">   
  <h3 class="text-center font-weight-bold">Accordion<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Accordions allow you to display information under collapsed 'drawers' that a user can click to reveal or hide the information." class="hideableinstruct text-success font-weight-normal small">&nbsp;<i class="fa fa-question-circle"></i></span></h3>
  <h5 class="text-center"><a class="hideableinstruct" data-toggle="modal" data-target=".btnWalkthrough" href="">Creating an accordion (07:08)</a></h5>
<!--Begin modal content on the page-->
<!--Button creation video walkthrough-->
            <div class="modal fade btnWalkthrough" tabindex="-1" role="dialog" aria-labelledby="btn-modal" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content p-2 bg-dark">
                <div class="modal-header">
                  <h5 class="modal-title text-white">Click close or click outside this box to return to the BEEST.</h5>
                  <button type="button" class="btn btn-outline-light btn-lg ml-2" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Close &times;</span>
                  </button>
                </div>
              <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=a3b32c11-7614-4ec4-8104-ac4000328f01"></iframe></div>
              </div>
            </div>
          </div>
<!--End button walkthrough modal-->
<!--How to paste HTML into Moodle modal-->
<div class="modal fade html-paste-modal" tabindex="-1" role="dialog" aria-labelledby="html-paste-modal" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content p-2 bg-dark">
      <div class="modal-header">
        <h5 class="modal-title text-white">Click close or click outside this box to return to the BEEST.</h5>
        <button type="button" class="btn btn-outline-light btn-lg ml-2" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">Close &times;</span>
        </button>
      </div>
    <div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" frameborder="0" allowfullscreen="allowfullscreen" src="https://monash-panopto.aarnet.edu.au/Panopto/Pages/Embed.aspx?id=d1c0ffaa-23a4-4d38-bb49-abda00b7805a"></iframe>
    </div>
    </div>
  </div>
</div>
<!--End HTML paste video walkthrough-->
<!--End modal content for this page-->
<div class="row w-50 mx-auto text-center mt-3">	  
  <div class="col-lg">
  <a data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Click this button to clear the page and start again." href="javascript:window.location.reload()" class="btn btn-danger btn-lg btn-block mb-2" role="button">Clear the page <i class="fa fa-fw fa-refresh"></i></a>
  </div>
  <div class="col-lg">
  <button id="toggleHelp" data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus click" title="Click this button to toggle the help instructions on the page on/off. Only do this if you are completely familiar with how to use the page" onclick="flipTooltip()" class="btn btn-success btn-lg btn-block mb-2">Turn <span class="onoffswapinstr">off</span> help <i class="fa fa-fw fa-power-off"></i></a>
  </div>
</div>
<hr class="hr-3">
<div class="row w-100 mx-auto">
  <div class="col-lg-6">
  <div class="row w-100">
            <div class="col-lg-3">
              <h5>Recover<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="Retrieve your previous button configuration. Only works once you have created at least 1 button. Then the next 20 configurations will be available until you clear your internet browser history or change internet browsers or create more than 20 buttons." class="hideableinstruct text-success small">&nbsp;<i class="fa fa-fw fa-question-circle"></i></h5>
            </div>              
              <div class="col-lg">
                <div class="row w-100">
                <div class="col-lg-11">
                <select class="custom-select border border-dark" size="1" id="recoveryDate" onchange="idSelectedRecData()">
                <option selected value=0>please wait</option>
                </select>
              </div>
          
                <div class="col-lg-1 text-center">
                <button data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus click" title="Click this button to delete the item you have selected in the dropdown." id="delHist" onclick="delHistI()" type="button" class="btn btn-danger"><i class="fa fa-fw fa-trash"></i></button>     
                </div>
              </div>
            </div>
          </div>
		 
	<hr>
	
		  <div class="row w-100">
        <div class="col-lg-3">
			<h5>Paste code from Moodle<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="" class="hideableinstruct text-success small" style="display: none;" data-original-title="Paste in the code you previously generated from BEEST and pasted into Moodle to recover and redesign the element.">&nbsp;<i class="fa fa-question-circle" aria-hidden="true"></i></span></h5>
		</div>
		<div class="col-lg">
			<textarea class="rounded p-2 w-100 mt-2" rows="2" name="retrieveCode" type="text" id="retrieveCode" placeholder="Copy previously generated BEEST code from Moodle and paste it here" onchange="recoverCode()"></textarea>
            <div id="paste-help"></div>
		</div>
	</div>



		  
            <hr>
			
  
  <div class="row w-100">
  
    <div class="col-lg-3">
	
      <h5>Main heading<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Type the main heading for this accordion that will sit above the element and indicate to students what is in the accordion. 75 character maximum.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
    </div>
    <div class="col-lg">
    <textarea maxlength="75" class="rounded p-2 w-100" rows="1" name="accMainHeading" type="text" id="accMainHeading" placeholder="Type your accordion heading here" onchange=generateElementCode()></textarea>
    </div>
    </div>
    <hr>
<div class="row w-100">
  <div class="col-lg-3">
    <h5>Main heading size<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose the size of your heading. No heading is chosen by default. If you do not choose a heading size, your heading will not display.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
  </div>
  <div class="col-lg">
<div class="form-check form-check-inline" id="headSize" onchange=generateElementCode()>
  <input class="form-check-input" name="headSize" id="headSize1" type="radio" value="noH" checked>
  <label class="form-check-label" for="headSize1">No heading</label>
</div>
<div class="form-check form-check-inline" id="headSize" onchange=generateElementCode()>
  <input class="form-check-input" name="headSize" id="headSize2" type="radio" value="h5">
  <label class="form-check-label" for="headSize2"><h5>Small</h5></label>
</div>
<div class="form-check form-check-inline" id="headSize" onchange=generateElementCode()>
  <input class="form-check-input" name="headSize" id="headSize3" type="radio" value="h4">
  <label class="form-check-label" for="headSize3"><h4>Medium</h4></label>
</div>
<div class="form-check form-check-inline" id="headSize" onchange=generateElementCode()>
  <input class="form-check-input" name="headSize" id="headSize4" type="radio" value="h3">
  <label class="form-check-label" for="headSize4"><h3>Large</h3></label>
</div>
  </div>
</div>
<hr>
          <div class="row w-100">
            <div class="col-lg-3">
              <h5>Choose icon<span data-toggle="tooltip" data-placement="bottom" data-trigger="hover focus" title="If you would like an icon to the right of your button text, choose one from this list." class="small hideableinstruct text-success">&nbsp;<i class="fa fa-question-circle"></i></span></h5> 
            </div>
            <div class="col-lg-1 my-auto mr-3 pb-3">
            <div class="form-check form-check-inline" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCodeNone" type="radio" value="noI" checked>
              <label class="form-check-label h5" for="faCodeNone">None</label>
            </div>
          </div>
            <div class="col-lg">
              <div class="row w-100">
                <div class="col-lg d-flex justify-content-between">
              <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
                <input class="form-check-input" name="faCode" id="faCode1" type="radio" value="1">
                <label class="form-check-label" for="faCode1"><i class="fa fa-fw fa-database fa-2x"></i></label>
              </div>
              <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode2" type="radio" value="2">
              <label class="form-check-label" for="faCode2"><i class="fa fa-fw fa-question fa-2x"></i></label>
              </div>
              <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
                <input class="form-check-input" name="faCode" id="faCode3" type="radio" value="3">
                <label class="form-check-label" for="faCode3"><i class="fa fa-fw fa-question-circle fa-2x"></i></label>
                </div>
              <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode4" type="radio" value="4">
              <label class="form-check-label" for="faCode4"><i class="fa fa-fw fa-question-circle-o fa-2x"></i></label>
            </div>
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode5" type="radio" value="5">
              <label class="form-check-label" for="faCode5"><i class="fa fa-fw fa-info fa-2x"></i></label>
            </div>
          </div>
        </div>
            <div class="row w-100 mt-2">
              <div class="col-lg d-flex justify-content-between">
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode6" type="radio" value="6">
              <label class="form-check-label" for="faCode6"><i class="fa fa-fw fa-info-circle fa-2x"></i></label>
            </div>
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode7" type="radio" value="7">
              <label class="form-check-label" for="faCode7"><i class="fa fa-fw fa-exclamation fa-2x"></i></label>
            </div>
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode8" type="radio" value="8">
              <label class="form-check-label" for="faCode8"><i class="fa fa-fw fa-exclamation-triangle fa-2x"></i></label>
            </div>
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode9" type="radio" value="9">
              <label class="form-check-label" for="faCode9"><i class="fa fa-fw fa-exclamation-circle fa-2x"></i></label>
            </div>
            <div class="form-check form-check-inline mx-1" id="faCode" onchange=generateElementCode()>
              <input class="form-check-input" name="faCode" id="faCode10" type="radio" value="10">
              <label class="form-check-label" for="faCode10"><i class="fa fa-fw fa-life-ring fa-2x"></i></label>
            </div>
          </div>
        </div>
      </div>
    </div>
          <hr>
		  

<div class="row w-100">
		<div class="col-lg-3">
	   <h5>Drawer Heading<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose the heading size of the first row. Small is chosen by default.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
		</div>
		<div class="col-lg">
	  <div class="form-check form-check-inline" id="drawerSize" onchange=generateElementCode()>
		<input class="form-check-input" name="drawerSize" id="drawerSize1" type="radio" value="h5" checked>
		<label class="form-check-label" for="drawerSize1"><h5>Small</h5></label>
	  </div>
	  <div class="form-check form-check-inline" id="drawerSize" onchange=generateElementCode()>
		<input class="form-check-input" name="drawerSize" id="drawerSize2" type="radio" value="h4">
		<label class="form-check-label" for="drawerSize2"><h4>Medium</h4></label>
	  </div>
	  <div class="form-check form-check-inline" id="drawerSize" onchange=generateElementCode()>
		<input class="form-check-input" name="drawerSize" id="drawerSize3" type="radio" value="h3">
		<label class="form-check-label" for="drawerSize3"><h3>Large</h3></label>
	  </div>
		</div>
	  </div>		  
		<hr> 

	<div class="row w-100">
		<div class="col-lg-3">
	   <h5>Drawer Style<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose the colour/style of the first row. Dark is chosen by default.">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
		</div>
		<div class="col-lg">
	  <div class="form-check form-check-inline" id="bgStyle" onchange=generateElementCode()>
		<input class="form-check-input" name="bgStyle" id="bgStyle1" type="radio" value="heading-dk text-white,cardborder-dk">
		<label class="form-check-label" for="bgStyle1"><table class="table table-bordered table-hover table-striped table-responsive-lg border border-dark"><thead class="thead-dark"><th>Dark</th></thead></table></label>
	  </div>
	  <div class="form-check form-check-inline" id="bgStyle" onchange=generateElementCode()>
		<input class="form-check-input" name="bgStyle" id="bgStyle2" type="radio" value="heading-pm text-black,cardborder-pm">
		<label class="form-check-label" for="bgStyle2"><table class="table table-bordered table-hover table-striped table-responsive-lg border border-dark"><thead class="table-primary"><th>Sky Blue</th></thead></table></label>
	  </div>
	  <div class="form-check form-check-inline" id="bgStyle" onchange=generateElementCode()>
		<input class="form-check-input" name="bgStyle" id="bgStyle3" type="radio" value="heading-sc text-black,cardborder-sc">
		<label class="form-check-label" for="bgStyle3"><table class="table table-bordered table-hover table-striped table-responsive-lg border border-dark"><thead class="table-secondary"><th>Grey</th></thead></table></label>
	  </div>
	  <div class="form-check form-check-inline" id="bgStyle" onchange=generateElementCode()>
		<input class="form-check-input" name="bgStyle" id="bgStyle4" type="radio" value="heading-mu text-white,cardborder-mu" checked>
		<label class="form-check-label" for="bgStyle4"><table class="table table-bordered table-hover table-striped table-responsive-lg border border-dark"><thead class="bg-mu"><th>Monash Blue</th></thead></table></label>
	  </div>	  
		</div>
	  </div>		  
		<hr>
		<div class="row w-100">
  <div class="col-lg-3">
    <h5>Load with...<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Choose whether the first block of the accordion starts expanded or collapsed. The default is open/expanded">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
  </div>
  <div class="col-lg">
<div class="form-check form-check-inline" id="openClose" onchange=generateElementCode()>
  <input class="form-check-input" name="openClose" id="openClose1" type="radio" value="open" checked>
  <label class="form-check-label" for="openClose1">First block open</label>
</div>
<div class="form-check form-check-inline" id="openClose" onchange=generateElementCode()>
  <input class="form-check-input" name="openClose" id="openClose2" type="radio" value="closed">
  <label class="form-check-label" for="openClose2">First block closed</label>
</div>

</div>
  </div>
<hr>
<div class="row w-100">
  <div class="col-lg">
<h5>Drawer headings & content<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="Input the headings that will appear on the accordion drawers and the content that will sit inside each of the drawers. The max length allowed for headings is 75 characters.">&nbsp;<i class="fa fa-question-circle"></i></span></h5> 
  </div>
</div>
<span>
<div class="row w-100">
  <div class="col-lg">
<h6>Heading 1</h6>
<textarea maxlength="75" class="border border-dark rounded p-2 w-100 mx-auto" rows="1" placeholder="Input the heading for your first accordion drawer here" id="monAccBtnTxt1" onchange=generateElementCode()></textarea>
</div>
</div>
<div class="row w-100 mt-2">
  <div class="col-lg">
        <h6>Content 1</h6>      
        <textarea id="tinyMCEmonAccContent1" class="border border-dark rounded p-2 w-100" rows="3" name="monAccContent1" placeholder="Write the content for your accordion here" onchange=generateElementCode()></textarea>
      </div>
    </div>
	</span>
    <hr>
    <span id="newAccordArea"></span>   
</div>
  <div class="col-lg">
	<div class="sticky-top" style="top:100px;">
		<h5>Add/Remove drawers + Current number of drawers<span class="text-success hideableinstruct small" data-toggle="tooltip" data-placement="right" data-trigger="hover focus" title="The page defaults to start with 3 accordion drawers. You can have up to 10. You can type in your number in the box on the right, which will also display the current number of drawers OR use the Add button to add more drawers one at a time. A remove button will appear once there are more than 3 drawers to remove drawers individually." >&nbsp;<i class="fa fa-question-circle"></i></span></h5> 
	<div class="btn-group btn-group-justified" role="group" id="addMinusButtons">
    <div class="btn-group" role="group">
		<button id="minusbutton" onclick="removeSection()" type="button" class="btn btn-danger rounded"><i class="fa fa-fw fa-minus"></i></button>
		<input class="border border-dark w-25 rounded btn btn-outline-dark mx-3 my-auto" style="cursor:default ;" id="accordCounter" onchange="changeDrawerCount()" value=0>
    <button id="plusbutton" onclick="addSection(true)" type="button" class="btn btn-success rounded"><i class="fa fa-fw fa-plus"></i></button>
  </div>
  </div>
	<hr>
	<div class="row w-100">
		<div class="col-lg-2">
		  <h5 class="font-weight-bold">Preview</h5>
		<div class="text-center mb-2 previewButton"> 
		  <button type="button" class="btn btn-outline-dark" style="padding: .5rem .7rem;" id="togglePreviewFS" data-toggle="tooltip" data-placement="top" data-trigger="hover focus" title="Click to expand the preview to fullscreen. Click again or press Escape to return here to the editing screen."><i class="fa fa-fw fa-expand"></i></button>
		 </div>
		</div>
		<div class="col-lg bg-white" id="previewFS">
		  <div id="demo"></div>
		</div>
		</div>
		<hr>
		<div class="row w-100">
			<div class="col-lg">
  <h5>Copy code<span data-toggle="tooltip" data-placement="top" data-trigger="hover focus" title="Click the copy code button below to copy your code, ready to paste into Moodle." class="hideableinstruct text-success small">&nbsp;<i class="fa fa-question-circle"></i></span></h5>
  <textarea readonly class="rounded p-2 w-100" id="monAccCode" rows="3" name="Result" placeholder="The code for your element will appear here as you update your preferences on the page." onClick=generateElementCode()></textarea>
    <div class="row w-100">
        <div class="col-lg-6">
            <input data-toggle="tooltip" data-placement="bottom" data-trigger="click" title="Your code has been copied." id="copyCodeBtn" class="btn btn-success btn-lg btn-block mt-2" name="GenerateWrap" value="Copy your code </>" OnClick=copyCode() >
        </div>
        <div class="col-lg-6">
            <input data-toggle="tooltip" data-placement="bottom" data-trigger="click" title="Your code has been inserted." id="insertCodeBtn" class="btn btn-success btn-lg btn-block mt-2" name="insertWrap" value="Insert your code </>" OnClick='insertCode()' >
            <div id="input-help"></div>
        </div>
    </div>
<div class="text-center h5 mt-4">
<a data-toggle="modal" data-target=".html-paste-modal" href="#">How do I paste this into Moodle?</a>
</div>
</div>
</div>
</div>
</div>
</div>
    </form>
    <div class="text-center">
    <a id="back-to-top" href="#" class="btn btn-lg btn-outline-dark back-to-top" role="button"><i class="fas fa-chevron-up"></i></a>
  </div>
    </div>
    <div id="beestFooter"></div>
        </body>
        </html>